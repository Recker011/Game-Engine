<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Engine Canvas</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            width: 100%;
            height: 100%;
            background-color: #000000;
        }
        #gameCanvas {
            display: block;
            background-color: #000000;
            width: 100vw;
            height: 100vh;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Set canvas dimensions to match window
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        // Initialize canvas size
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // FPS tracking variables
        let lastTime = 0;
        let fps = 0;
        let frameCount = 0;
        let fpsUpdateTime = 0;
        
        // Game loop
        function gameLoop(timestamp) {
            // Calculate delta time for smooth animation
            const deltaTime = timestamp - lastTime;
            lastTime = timestamp;
            
            // Update FPS counter every 500ms for smoothness
            frameCount++;
            if (timestamp >= fpsUpdateTime + 500) {
                fps = Math.round((frameCount * 1000) / (timestamp - fpsUpdateTime));
                frameCount = 0;
                fpsUpdateTime = timestamp;
            }
            
            // Clear canvas with black background
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw FPS counter in top-left corner
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '16px Arial';
            ctx.fillText(`FPS: ${fps}`, 10, 25);
            
            // Continue the game loop
            requestAnimationFrame(gameLoop);
        }
        
        // Prevent right-click context menu
        canvas.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
        
        // Prevent text selection
        canvas.addEventListener('selectstart', function(e) {
            e.preventDefault();
        });
        
        // Prevent drag
        canvas.addEventListener('dragstart', function(e) {
            e.preventDefault();
        });
        
        // Long press detection variables
        let longPressTimer = null;
        let longPressStartTime = 0;
        let longPressStartX = 0;
        let longPressStartY = 0;
        const LONG_PRESS_THRESHOLD = 500; // 500ms
        const MOVE_THRESHOLD = 8; // 8px
        
        // Function to handle long press detection
        function startLongPressDetection(x, y, deviceType) {
            // Store the starting position
            longPressStartX = x;
            longPressStartY = y;
            
            // Store the start time
            longPressStartTime = Date.now();
            
            // Set the timer for long press detection
            longPressTimer = setTimeout(() => {
                console.log("LONG PRESS DETECTED on " + deviceType);
                // Reset the timer
                longPressTimer = null;
            }, LONG_PRESS_THRESHOLD);
        }
        
        // Function to cancel long press detection
        function cancelLongPressDetection() {
            if (longPressTimer) {
                clearTimeout(longPressTimer);
                longPressTimer = null;
            }
        }
        
        // Function to check if movement exceeds threshold
        function hasMovedBeyondThreshold(currentX, currentY) {
            const deltaX = Math.abs(currentX - longPressStartX);
            const deltaY = Math.abs(currentY - longPressStartY);
            return Math.sqrt(deltaX * deltaX + deltaY * deltaY) > MOVE_THRESHOLD;
        }
        
        // Mouse event handlers for long press detection
        canvas.addEventListener('mousedown', function(e) {
            // Only respond to left mouse button
            if (e.button !== 0) return;
            
            // Cancel any existing long press detection
            cancelLongPressDetection();
            
            // Start new long press detection
            startLongPressDetection(e.clientX, e.clientY, "desktop");
        });
        
        canvas.addEventListener('mousemove', function(e) {
            // If we're not detecting a long press, do nothing
            if (!longPressTimer) return;
            
            // Check if movement exceeds threshold
            if (hasMovedBeyondThreshold(e.clientX, e.clientY)) {
                cancelLongPressDetection();
            }
        });
        
        canvas.addEventListener('mouseup', function(e) {
            // Cancel long press detection on mouse up
            cancelLongPressDetection();
        });
        
        canvas.addEventListener('mouseleave', function(e) {
            // Cancel long press detection if mouse leaves canvas
            cancelLongPressDetection();
        });
        
        // Touch event handlers for long press detection
        canvas.addEventListener('touchstart', function(e) {
            // Prevent default behavior
            e.preventDefault();
            
            // Cancel any existing long press detection
            cancelLongPressDetection();
            
            // For simplicity, we'll only consider the first touch point
            if (e.touches.length > 0) {
                const touch = e.touches[0];
                startLongPressDetection(touch.clientX, touch.clientY);
            }
        });
        
        canvas.addEventListener('touchmove', function(e) {
            // Prevent default behavior
            e.preventDefault();
            
            // If we're not detecting a long press, do nothing
            if (!longPressTimer) return;
            
            // Check if movement exceeds threshold
            if (e.touches.length > 0) {
                const touch = e.touches[0];
                if (hasMovedBeyondThreshold(touch.clientX, touch.clientY)) {
                    cancelLongPressDetection();
                }
            }
        });
        
        canvas.addEventListener('touchend', function(e) {
            // Prevent default behavior
            e.preventDefault();
            
            // Cancel long press detection on touch end
            cancelLongPressDetection();
        });
        
        canvas.addEventListener('touchcancel', function(e) {
            // Prevent default behavior
            e.preventDefault();
            
            // Cancel long press detection on touch cancel
            cancelLongPressDetection();
        });
        
        // Start the game loop
        requestAnimationFrame(gameLoop);
    </script>
</body>
</html>